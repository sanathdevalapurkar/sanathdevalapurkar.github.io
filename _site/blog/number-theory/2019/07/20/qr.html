<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1"><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Quadratic reciprocity | Sanath Devalapurkar’s home page</title>
<meta name="generator" content="Jekyll v3.8.5" />
<meta property="og:title" content="Quadratic reciprocity" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Graduate student in math at Harvard." />
<meta property="og:description" content="Graduate student in math at Harvard." />
<link rel="canonical" href="http://localhost:4000/blog/number-theory/2019/07/20/qr.html" />
<meta property="og:url" content="http://localhost:4000/blog/number-theory/2019/07/20/qr.html" />
<meta property="og:site_name" content="Sanath Devalapurkar’s home page" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2019-07-20T00:00:00-04:00" />
<script type="application/ld+json">
{"headline":"Quadratic reciprocity","dateModified":"2019-07-20T00:00:00-04:00","datePublished":"2019-07-20T00:00:00-04:00","url":"http://localhost:4000/blog/number-theory/2019/07/20/qr.html","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/blog/number-theory/2019/07/20/qr.html"},"description":"Graduate student in math at Harvard.","@type":"BlogPosting","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/assets/main.css"><link type="application/atom+xml" rel="alternate" href="http://localhost:4000/feed.xml" title="Sanath Devalapurkar's home page" /></head>
<body><header class="site-header" role="banner">

  <div class="wrapper"><a class="site-title" rel="author" href="/">Sanath Devalapurkar&#39;s home page</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/blog/">Blog</a><a class="page-link" href="/">Home</a><a class="page-link" href="/thursday-spring-2022">Thursday seminar spring 2022</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Quadratic reciprocity</h1>
    <p class="post-meta">
      <time class="dt-published" datetime="2019-07-20T00:00:00-04:00" itemprop="datePublished">Jul 20, 2019
      </time></p>
  </header>

  <div class="post-content e-content" itemprop="articleBody">
    <script type="text/javascript" async="" src="https://www.google-analytics.com/analytics.js"></script>

<script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-109004213-1"></script>

<script>
  window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

        gtag('config', 'UA-109004213-1');
</script>

<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>

<script type="math/tex; mode=display">\newcommand{\KO}{\mathrm{KO}} \newcommand{\TMF}{\mathrm{TMF}}
\newcommand{\KU}{\mathrm{KU}} \newcommand{\Mfg}{M_\mathrm{fg}}
\newcommand{\spec}{\mathrm{Spec}\ } \newcommand{\dX}{\mathcal{X}}
\newcommand{\co}{\mathcal{O}} \newcommand{\Z}{\mathbf{Z}}
\newcommand{\top}{\mathrm{top}} \newcommand{\E}{\mathbf{E}}
\newcommand{\GG}{\mathbf{G}} \newcommand{\DD}{\mathbf{D}}
\newcommand{\Mell}{M_\mathrm{ell}} \newcommand{\ce}{\mathcal{E}}
\newcommand{\H}{\mathrm{H}} \newcommand{\dR}{\mathrm{dR}}
\newcommand{\cf}{\mathcal{F}} \newcommand{\FF}{\mathbf{F}}
\newcommand{\spf}{\mathrm{Spf}\ } \newcommand{\cA}{\mathcal{A}}
\newcommand{\Mcub}{M_\mathrm{cub}} \newcommand{\Mqd}{M_\mathrm{qd}}
\newcommand{\Aut}{\mathrm{Aut}} \newcommand{\tmf}{\mathrm{tmf}}
\newcommand{\Tmf}{\mathrm{Tmf}} \newcommand{\Map}{\mathrm{Map}}
\newcommand{\Ext}{\mathrm{Ext}} \newcommand{\End}{\mathrm{End}}
\newcommand{\cg}{\mathcal{G}} \newcommand{\Hom}{\mathrm{Hom}}
\newcommand{BP}{\mathrm{BP}} \newcommand{\QQ}{\mathbf{Q}}
\newcommand{\PP}{\mathbf{P}} \newcommand{\Gal}{\mathrm{Gal}}
\newcommand{\proj}{\mathrm{Proj}\ } \newcommand{\Ltwo}{L_{K(2)}}
\newcommand{\Eoo}{\mathbf{E}_\infty} \newcommand{\ol}[1]{\overline #1}
\newcommand{\pic}{\mathrm{Pic}} \newcommand{\RP}{\mathbf{R}P}
\newcommand{\BO}{\mathrm{BO}} \newcommand{\cc}{\mathbf{C}}
\newcommand{\CP}{\mathbf{C}P} \newcommand{\wt}[1]{\widetilde #1}
\newcommand{\RR}{\mathbf{R}} \renewcommand{\S}{\mathbb{S}}
\newcommand{\Lone}{L_{K(1)}} \newcommand{\Ltwo}{L_{K(2)}}
\newcommand{\gl}{\mathrm{gl}} \newcommand{\Lk}{L_{K(n)}}
\newcommand{\ku}{\mathrm{ku}} \newcommand{\ko}{\mathrm{ko}}
\newcommand{\GL}{\mathrm{GL}} \newcommand{\Ln}{L_n} \newcommand{\Lt}{L_{K(t)}}
\newcommand{\W}{\mathrm{W}} \newcommand{\BU}{\mathrm{BU}}
\newcommand{\SU}{\mathrm{SU}} \newcommand{\MU}{\mathrm{MU}}
\newcommand{\ul}[1]{\underline #1} \newcommand{\Sq}{\mathrm{Sq}}
\newcommand{\Tr}{\mathrm{Tr}} \newcommand{\d}{\mathrm{d}}
\newcommand{\HP}{\mathbf{H}P} \newcommand{\cL}{\mathcal{L}}
\newcommand{\cs}{\mathrm{cs}} \newcommand{\cd}{\mathcal{D}}
\newcommand{\Bord}{\mathrm{Bord}} \newcommand{\SO}{\mathrm{SO}}
\newcommand{\cC}{\mathcal{C}} \newcommand{\Sp}{\mathrm{Sp}}
\newcommand{\Lkd}{L_{K(d)}} \newcommand{\Mod}{\mathrm{Mod}}
\newcommand{\cH}{\mathcal{H}} \newcommand{\ket}[1]{|#1 \rangle}
\newcommand{\Bun}{\mathrm{Bun}} \newcommand{\cM}{\mathcal{M}}
\newcommand{\MTH}{\mathrm{MT}H} \newcommand{\MSO}{\mathrm{MSO}}
\newcommand{\twsm}{\ \widetilde{\wedge} \ } \newcommand{\BSpin}{\mathrm{BSpin}}
\newcommand{\MSpin}{\mathrm{MSpin}} \newcommand{\BString}{\mathrm{BString}}
\newcommand{\MString}{\mathrm{MString}} \newcommand{\B}{\mathrm{B}}
\newcommand{\der}{\mathrm{der}} \newcommand{\Cat}{\mathrm{Cat}}
\newcommand{\QCoh}{\mathrm{QCoh}} \newcommand{\LMod}{\mathrm{LMod}}
\newcommand{\Rep}{\mathrm{Rep}} \newcommand{\HH}{\mathbf{H}}
\newcommand{\ZZ}{\mathfrak{Z}} \newcommand{\fr}{\mathrm{fr}}
\newcommand{\BSO}{\mathrm{BSO}} \newcommand{\BSU}{\mathrm{BSU}}
\newcommand{\id}{\mathrm{id}} \newcommand{\Top}{\mathrm{Top}}
\newcommand{\cP}{\mathcal{P}} \newcommand{\U}{\mathrm{U}}
\newcommand{\Sym}{\mathrm{Sym}} \newcommand{\coker}{\mathrm{coker}}
\newcommand{\Vect}{\mathrm{Vect}} \newcommand{\Fun}{\mathrm{Fun}}
\newcommand{\cT}{\mathcal{T}} \newcommand{\cJ}{\mathcal{J}}
\newcommand{\Res}{\mathrm{Res}} \newcommand{\Ind}{\mathrm{Ind}}
\newcommand{\Pic}{\mathrm{Pic}} \newcommand{\fr}[1]{\mathfrak #1}
\newcommand{\Stab}{\mathrm{Stab}}</script>

<p><a href="/algebraic-topology/2019/07/19/central-1.html">Last time</a>, I complained about
how many posts are in my backlog, but I recently learnt of this cool proof of
quadratic reciprocity from someone at UChicago, and I couldn’t help writing a
post about it (source being <a href="https://people.kth.se/~akarl/langmemorial.pdf">this
document</a>).</p>

<p>Let <script type="math/tex">\Lambda\subseteq \RR^n</script> be a lattice; then, the <script type="math/tex">\theta</script>-function
<script type="math/tex">\theta_\Lambda(z)</script> is defined as</p>

<script type="math/tex; mode=display">\theta_\Lambda(z) = \sum_{v\in \Lambda} e^{\pi i z \langle v, v\rangle}.</script>

<p>If <script type="math/tex">\Lambda</script> is self-dual, then Poisson summation (I originally had a long
post about how Morita theory generalizes Poisson summation, and applying Poisson
summation to get dualities in TQFTs, but never finished it) implies that</p>

<script type="math/tex; mode=display">\theta_\Lambda(-1/z) = \left(\frac{z}{i}\right)^{n/2} \theta_\Lambda(z)</script>

<p>for any <script type="math/tex">0\neq z\in \HH</script>. In particular, if <script type="math/tex">n=1</script> (so we choose <script type="math/tex">\Lambda =
\Z \subseteq \RR</script>) and <script type="math/tex">z=it</script>, then we find that</p>

<script type="math/tex; mode=display">\theta_\Lambda(i/t) = t^{1/2} \theta_\Lambda(it).</script>

<p>We’ll write <script type="math/tex">\theta(t) = \theta_\Lambda(t) = \sum_{n\in \Z} e^{-\pi n^2 t}</script>.
Hecke observed that this functional equation for <script type="math/tex">\theta(t)</script> implies quadratic
reciprocity. In this post, we’ll give a proof of this fact through purely
analytic methods, and then discuss <em>why</em> the proof works (from an algebraic
viewpoint).</p>

<p>First, recall that quadratic reciprocity is equivalent to the claim that for any
prime number <script type="math/tex">p</script>, we have</p>

<script type="math/tex; mode=display">% <![CDATA[
\sum^{p-1}_{k=0} e^{2\pi i k^2/p} = \begin{cases}
\sqrt{p} & p\equiv 1\pmod{4}\\
i\sqrt{p} & p\equiv 3\pmod{4}.
\end{cases} \quad (\ast) %]]></script>

<p>Indeed, if we define the Gauss sum (for <script type="math/tex">a</script> and <script type="math/tex">b</script> odd)</p>

<script type="math/tex; mode=display">G(a,b) = \sum_{k=0}^{b-1} e^{2\pi i k^2 a/b} = \sum_{n\in (\Z/b)^\times}^b
\chi(n) e^{2\pi i n a/b},</script>

<p>where <script type="math/tex">\chi</script> is the Jacobi symbol (thought of as a Dirichlet character), then
it is easy to see that if <script type="math/tex">p</script> and <script type="math/tex">q</script> are primes, we have <script type="math/tex">G(1,pq) = G(p,q)
G(q,p)</script> and <script type="math/tex">G(n,p) = \chi(n) G(1,p)</script>, where <script type="math/tex">p\not\mid n</script>. (Recall that
<script type="math/tex">\chi</script> is the Jacobi symbol, which reduces to the Legendre symbol over the
group of units of a finite field.) We therefore have</p>

<script type="math/tex; mode=display">\left(\frac{p}{q}\right) \left(\frac{q}{p}\right) = \frac{G(p,q)
G(q,p)}{G(1,p) G(1,q)} = \frac{G(1,pq)}{G(1,p) G(1,q)};</script>

<p>now, note that the left hand side of Equation <script type="math/tex">(\ast)</script> is exactly <script type="math/tex">G(1,p)</script>.
Using this, we calculate that <script type="math/tex">\frac{G(1,pq)}{G(1,p) G(1,q)} = (-1)^{(p-1)
(q-1)/4}</script>, as desired.</p>

<p>OK, so we need to prove <script type="math/tex">(\ast)</script>. This is a consequence of the following more
general formula, known as the Landsberg-Schaar identity (which is true for any
<script type="math/tex">p,q</script> coprime integers):</p>

<script type="math/tex; mode=display">\frac{1}{\sqrt{p}} \sum^{p-1}_{n=0} e^{2\pi i n^2 q/p} = \frac{e^{\pi
i/4}}{\sqrt{2q}} \sum_{n=0}^{2q-1} e^{-\pi i n^2 p/2q}.</script>

<p>Setting <script type="math/tex">q=1</script> in this equation recovers <script type="math/tex">(\ast)</script>. The key point now is that
the Landsberg-Schaar identity is implied by the functional equation for
<script type="math/tex">\theta(t)</script>. To see this, first note that <script type="math/tex">\theta(t) = 1+2\sum_{n\geq 1}
e^{-\pi n^2 t}</script>. Therefore,</p>

<script type="math/tex; mode=display">\theta(t-2iq/p) = 1 + 2\sum_{n\geq 1} e^{-\pi n^2 t} e^{2\pi i n^2 q/p} = 1 +
2\sum_{n=0}^{p-1} \left(e^{2\pi i n^2 q/p} \sum_{m\geq 0} e^{-\pi (n+mp)^2
t}\right).</script>

<p>We’ll be taking <script type="math/tex">t</script> to zero; in this case, we can view the interior sum as a
Riemann integral:</p>

<script type="math/tex; mode=display">\sum_{m\geq 0} e^{-\pi (n+mp)^2 t} = \int^\infty_0 e^{-\pi (n+xp)^2 t} dx =
\frac{1}{\pi p \sqrt{t}} \left(\frac{\sqrt{\pi}}{2} + o(1)\right).</script>

<p>It follows that as <script type="math/tex">t\to 0</script>, we have:</p>

<script type="math/tex; mode=display">\theta(t-2iq/p) = \frac{1}{p\sqrt{t}} \left(\sum_{n=0}^{p-1} e^{2\pi i n^2
q/p} + o(1)\right).</script>

<p>Now, we know from the functional equation for <script type="math/tex">\theta</script> that this is also equal
to <script type="math/tex">\frac{1}{\sqrt{t-2iq/p}} \theta\left(\frac{1}{t-2iq/p}\right)</script>. But</p>

<script type="math/tex; mode=display">\frac{1}{t-2iq/p} = \frac{i}{2} \frac{p}{q} + \frac{t}{4} \frac{q^2}{p^2} +
O(t^2),</script>

<p>so by the same analysis as above, we find that</p>

<script type="math/tex; mode=display">\theta\left(\frac{1}{t-2iq/p}\right) = \frac{1}{p\sqrt{\pi t}}
\left(\sum_{n=0}^{2q-1} e^{-in^2 p/2q} + o(1)\right).</script>

<p>Since <script type="math/tex">1/\sqrt{t-2iq/p} = e^{i\pi/2} \sqrt{p/2q} + o(1)</script>, we obtain the
Landsberg-Schaar identity.</p>

<hr />

<p>This deduction of quadratic reciprocity from the modularity of the
<script type="math/tex">\theta</script>-function is indicative of something deeper. The existence of such a
relationship might not be surprising to seasoned number theorists, but I’m not
one. In the rest of this post (still under construction), we’ll discuss how the
story described above fits into a more general algebraic context.</p>

  </div><a class="u-url" href="/blog/number-theory/2019/07/20/qr.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/"></data>

  <div class="wrapper">

    <h2 class="footer-heading">Sanath Devalapurkar&#39;s home page</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">
          <li class="p-name">Sanath Devalapurkar&#39;s home page</li><li><a class="u-email" href="mailto:sdevalapurkar@math.harvard.edu">sdevalapurkar@math.harvard.edu</a></li></ul>
      </div>

      <div class="footer-col footer-col-2"><ul class="social-media-list"></ul>
</div>

      <div class="footer-col footer-col-3">
        <p>Graduate student in math at Harvard.</p>
      </div>
    </div>

  </div>

</footer>
</body>

</html>
